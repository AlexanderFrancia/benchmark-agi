{% extends "base.html" %}
{% block content %}
<h2>ARC Tasks</h2>
<p>Buscando en <code>data/arcagi2/</code></p>

<!-- Botón general con selector de modelo -->
<form method="post" style="margin: 0 0 1rem 0;">
  {% csrf_token %}
  <label for="model_id"><b>Modelo</b></label>
  <select id="model_id" name="model_id" required>
    {% for mid in models %}
      <option value="{{ mid }}" {% if mid == selected_model %}selected{% endif %}>{{ mid }}</option>
    {% empty %}
      <option disabled>No hay modelos disponibles. Abre LM Studio y carga uno.</option>
    {% endfor %}
  </select>
  {% if lm_error %}<small>Error al listar modelos: {{ lm_error }}</small>{% endif %}

  <!-- Dos acciones con el mismo form -->
  <button type="submit" formaction="{% url 'arc_evaluate_dataset_live' %}" style="margin-left:.5rem">
    ⚡ Evaluar TODO (live)
  </button>
  <button type="submit" formaction="{% url 'arc_evaluate_dataset' %}" style="margin-left:.25rem">
    Evaluar TODO (secuencial)
  </button>
</form>

<table>
  <thead>
    <tr><th>Task ID</th><th>Split</th><th>Acción</th></tr>
  </thead>
  <tbody>
    {% for t in tasks %}
      <tr>
        <td><code>{{ t.task_id }}</code></td>
        <td>{{ t.split }}</td>
        <td><a href="{% url 'arc_detail' t.task_id %}">ver</a></td>
      </tr>
    {% empty %}
      <tr><td colspan="3">No se encontraron tareas. Coloca JSONs en <code>data/arcagi2/train/</code>.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
